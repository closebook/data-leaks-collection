<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>OPEN DATA BREACH // TERMINAL v1.0</title>

<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    
    /* Disable text selection everywhere */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    
    /* Better touch handling for mobile */
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
}

/* CRT screen effect */
body {
    background: #0a0c0f;
    height: 100vh;
    height: -webkit-fill-available;
    width: 100vw;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #c0d0e0;
    overflow: hidden;
    font-family: 'Share Tech Mono', monospace;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
}

/* scanlines */
body::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.15) 0px,
        rgba(0, 0, 0, 0.15) 1px,
        transparent 1px,
        transparent 2px
    );
    pointer-events: none;
    z-index: 10;
    opacity: 0.3;
}

/* vintage monitor glow - MOBILE OPTIMIZED */
.monitor {
    width: 980px;
    max-width: 98vw;
    height: 90vh;
    max-height: -webkit-fill-available;
    background: #030608;
    border-radius: 20px;
    box-shadow: 
        0 0 0 2px rgba(20, 80, 120, 0.3),
        0 0 0 5px #0a1a1f,
        0 0 20px rgba(0, 180, 255, 0.2),
        inset 0 0 30px rgba(0, 0, 0, 0.9);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    z-index: 2;
    position: relative;
    margin: 0 auto;
}

/* bevel effect */
.monitor::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 20px;
    box-shadow: inset 0 0 30px rgba(0, 30, 50, 0.8);
    pointer-events: none;
    z-index: 3;
}

/* top bar with retro look - MOBILE FRIENDLY */
.topbar {
    height: 44px;
    background: linear-gradient(to bottom, #1a2a2f, #0a1419);
    display: flex;
    align-items: center;
    padding: 0 12px;
    border-bottom: 1px solid #2a4a55;
    box-shadow: inset 0 -2px 0 #020608;
    position: relative;
    z-index: 5;
    
    /* Make top bar text unselectable */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    
    /* Larger touch area for mobile */
    min-height: 44px;
}

.led {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 8px;
    box-shadow: 0 0 5px currentColor;
    
    /* LEDs don't need text selection */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.red-led { background: #ff5f5f; box-shadow: 0 0 8px #ff3f3f; }
.yellow-led { background: #ffcf5f; box-shadow: 0 0 8px #ffaf2f; }
.green-led { background: #5fff5f; box-shadow: 0 0 8px #2fcf2f; }

.terminal-title {
    color: #7fa5b0;
    margin-left: 8px;
    font-size: 13px;
    letter-spacing: 1px;
    text-shadow: 0 0 5px rgba(100, 200, 255, 0.5);
    flex: 1;
    
    /* Make title unselectable */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    
    /* Mobile text size */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.terminal-status {
    color: #6f8f9f;
    font-size: 11px;
    border-left: 1px solid #2a4a55;
    padding-left: 10px;
    
    /* Make status unselectable */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    
    /* Mobile text size */
    white-space: nowrap;
}

/* screen with phosphor effect - MOBILE OPTIMIZED */
.screen {
    padding: 20px 18px;
    overflow-y: auto;
    overflow-x: hidden;
    font-family: 'Share Tech Mono', monospace;
    font-size: 16px;
    line-height: 1.6;
    flex: 1;
    color: #c0ffc0;
    text-shadow: 
        0 0 5px rgba(0, 255, 128, 0.5),
        0 0 12px rgba(0, 200, 100, 0.3);
    position: relative;
    background: radial-gradient(circle at 50% 50%, #030a0c, #010304);
    letter-spacing: 0.5px;
    
    /* Better touch scrolling */
    -webkit-overflow-scrolling: touch;
}

/* Increase font size for mobile */
@media (max-width: 600px) {
    .screen {
        font-size: 15px;
        padding: 16px 14px;
    }
    
    .boot-sequence {
        font-size: 12px !important;
    }
    
    .group {
        font-size: 15px !important;
    }
    
    .cursor {
        width: 10px !important;
        height: 18px !important;
    }
}

/* CRT phosphor dots */
.screen::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-radial-gradient(circle at 20% 30%, rgba(0, 150, 100, 0.03) 0px, transparent 1px);
    pointer-events: none;
    z-index: 2;
}

/* custom scrollbar - terminal style */
.screen::-webkit-scrollbar {
    width: 6px;
}
.screen::-webkit-scrollbar-track {
    background: #020a0c;
    box-shadow: inset 0 0 6px #000;
}
.screen::-webkit-scrollbar-thumb {
    background: #2a5a5f;
    border-radius: 0;
    border-left: 1px solid #4f9f9f;
    box-shadow: inset 0 0 8px #6fcfcf;
}

/* blinking cursor - retro terminal */
.cursor {
    display: inline-block;
    width: 12px;
    height: 20px;
    background: #80ffa0;
    box-shadow: 0 0 10px #2fff7f;
    animation: blink 1s infinite;
    vertical-align: middle;
    margin-left: 3px;
}
@keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
}

/* hacker groups - green phosphor */
.group {
    color: #8fffbf;
    text-shadow: 
        0 0 8px rgba(0, 255, 128, 0.9),
        0 0 15px rgba(0, 200, 0, 0.5);
    font-weight: bold;
    display: inline-block;
    word-break: break-word;
}

/* terminal prompt with path */
.prompt {
    color: #9fdfbf;
    text-shadow: 0 0 6px #2f9f6f;
}

.prompt::before {
    content: "┌─[";
    color: #6fbf8f;
}

.prompt::after {
    content: "]";
    color: #6fbf8f;
}

/* error messages - red phosphor */
.error {
    color: #ff9f8f;
    text-shadow: 
        0 0 8px #ff5f3f,
        0 0 12px #cf2f0f;
    margin-top: 8px;
    display: block;
    word-break: break-word;
}

/* success messages - green phosphor */
.success {
    color: #afff8f;
    text-shadow: 
        0 0 8px #4fef2f,
        0 0 15px #2faf0f;
    display: block;
    word-break: break-word;
}

/* ASCII border elements */
.ascii-border {
    color: #4f8f8f;
    text-shadow: 0 0 4px #2f6f6f;
    font-size: 15px;
    word-break: break-all;
}

/* input line with retro > - MOBILE OPTIMIZED */
.input-line {
    color: #cfffaf;
    text-shadow: 0 0 8px #6fef8f;
    display: inline-block;
    min-height: 24px;
    padding: 2px 0;
}

.input-line::before {
    content: ">";
    color: #8fdfaf;
    margin-right: 8px;
    font-weight: bold;
    text-shadow: 0 0 10px #2fcf6f;
}

/* hidden input for mobile - ENHANCED FOR MOBILE */
.hidden-input {
    position: fixed;
    top: 0;
    left: 0;
    opacity: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999;
    font-size: 16px;
}

/* terminal noise effect */
.noise {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="1" stitchTiles="stitch"/></filter><rect width="100" height="100" filter="url(%23noise)" opacity="0.08"/></svg>');
    pointer-events: none;
    opacity: 0.1;
    z-index: 20;
    mix-blend-mode: overlay;
}

/* boot sequence text - MOBILE OPTIMIZED */
.boot-sequence {
    color: #6faf9f;
    font-size: 13px;
    margin-bottom: 15px;
    border-bottom: 1px solid #2f5f5f;
    padding-bottom: 10px;
    word-break: break-word;
}

/* typing animation enhancement */
.typed-text {
    word-break: break-word;
}

/* vintage vignette */
.vignette {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    box-shadow: inset 0 0 100px rgba(0, 0, 0, 0.7);
    pointer-events: none;
    z-index: 25;
    border-radius: 20px;
}

/* data stream effect */
.data-stream {
    color: #4fbfaf;
    text-shadow: 0 0 5px #1f8f8f;
    font-size: 13px;
    opacity: 0.7;
}

/* Mobile keyboard open fix */
@media (max-height: 500px) {
    .monitor {
        height: 98vh;
    }
    
    .screen {
        padding: 12px 14px;
    }
}

/* Touch feedback */
.screen:active {
    background: radial-gradient(circle at 50% 50%, #041014, #010304);
}

/* Better focus states for mobile */
.hidden-input:focus {
    outline: none;
}
</style>
</head>

<body>

<!-- DISABLE RIGHT CLICK AND TOUCH MENU -->
<script>
// Disable right click completely
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    return false;
});

// Disable long press menu on mobile
document.addEventListener('touchstart', function(e) {
    if (e.touches.length > 1) {
        e.preventDefault();
    }
}, { passive: false });

document.addEventListener('gesturestart', function(e) {
    e.preventDefault();
});

// Also disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
document.addEventListener('keydown', function(e) {
    // F12
    if (e.key === 'F12') {
        e.preventDefault();
        return false;
    }
    
    // Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
    if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) {
        e.preventDefault();
        return false;
    }
    
    // Ctrl+U
    if (e.ctrlKey && e.key === 'u') {
        e.preventDefault();
        return false;
    }
    
    // Ctrl+Shift+C
    if (e.ctrlKey && e.shiftKey && e.key === 'C') {
        e.preventDefault();
        return false;
    }
    
    // Disable Ctrl+A on mobile
    if (e.ctrlKey && e.key === 'a') {
        e.preventDefault();
        return false;
    }
});

// Disable text selection via mouse and keyboard
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
    return false;
});

// Disable copy
document.addEventListener('copy', function(e) {
    e.preventDefault();
    return false;
});

// Disable cut
document.addEventListener('cut', function(e) {
    e.preventDefault();
    return false;
});

// Disable paste
document.addEventListener('paste', function(e) {
    e.preventDefault();
    return false;
});

// Prevent zoom on double tap for mobile
let lastTouchEnd = 0;
document.addEventListener('touchend', function(e) {
    const now = Date.now();
    if (now - lastTouchEnd <= 300) {
        e.preventDefault();
    }
    lastTouchEnd = now;
}, false);

// Prevent pinch zoom
document.addEventListener('touchmove', function(e) {
    if (e.touches.length > 1) {
        e.preventDefault();
    }
}, { passive: false });
</script>

<div class="monitor">
    <!-- CRT vignette overlay -->
    <div class="vignette"></div>
    <div class="noise"></div>
    
    <!-- TOP BAR - TEXT IS UNSELECTABLE -->
    <div class="topbar" unselectable="on" onselectstart="return false" onmousedown="return false" ontouchstart="return false">
        <div class="led red-led" unselectable="on"></div>
        <div class="led yellow-led" unselectable="on"></div>
        <div class="led green-led" unselectable="on"></div>
        <span class="terminal-title" unselectable="on">OPEN DATA BREACH // SECURE TERMINAL v1.0</span>
        <span class="terminal-status" unselectable="on">ENC: AES-256 | CH: 7</span>
    </div>

    <div class="screen" id="screenContainer">
        <div class="boot-sequence" unselectable="on">
            ═══════════════════════════════════════════<br>
            > SYSTEM BOOT SEQUENCE INITIATED<br>
            > KERNEL 4.19.0 OPENBREACH #1 SMP<br>
            > MEMORY: 4096MB / 4096MB<br>
            > SECURE ENCLAVE INITIALIZED<br>
            ═══════════════════════════════════════════
        </div>
        <span id="typed" class="typed-text"></span><span class="cursor"></span>
    </div>
</div>

<!-- Hidden input for mobile keyboard - ENHANCED FOR MOBILE -->
<input type="text" id="hiddenInput" class="hidden-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" inputmode="text" enterkeyhint="done">

<!-- Mobile instruction overlay -->
<div id="mobileInstruction" style="position: fixed; bottom: 20px; left: 0; right: 0; text-align: center; color: #6fbf8f; font-family: 'Share Tech Mono', monospace; font-size: 12px; text-shadow: 0 0 5px #2f9f6f; z-index: 100; pointer-events: none; display: none;">Tap screen to open keyboard</div>

<script>
// Disable right click again in JavaScript (double protection)
window.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    return false;
});

// Make all elements with class 'topbar' completely unselectable
document.addEventListener('DOMContentLoaded', function() {
    // Make top bar elements unselectable
    const topbarElements = document.querySelectorAll('.topbar, .terminal-title, .terminal-status, .led, .boot-sequence');
    topbarElements.forEach(function(el) {
        el.setAttribute('unselectable', 'on');
        el.style.webkitUserSelect = 'none';
        el.style.mozUserSelect = 'none';
        el.style.msUserSelect = 'none';
        el.style.userSelect = 'none';
    });
    
    // Check if mobile
    if (window.innerWidth <= 768) {
        document.getElementById('mobileInstruction').style.display = 'block';
        setTimeout(() => {
            document.getElementById('mobileInstruction').style.display = 'none';
        }, 5000);
    }
});

const bootSequence = `> SYSTEM READY
> NETWORK: TOR ENABLED
> NODE: 73.0.0.1 (HIDDEN)
> ACCESS: UNAUTHORIZED

`;

const paragraphs = ``;

const groups = [
];

const ending = `\n
> DATABASE: 47 ENTITIES FOUND
> CLASSIFICATION: CONFIDENTIAL
> ORIGIN: MULTIPLE SOURCES

This portal exists as a tribute to transparency.
Knowledge cannot be contained.

> AUTHENTICATION REQUIRED FOR ACCESS\n`;

const typed = document.getElementById("typed");
const screen = document.querySelector(".screen");
const hiddenInput = document.getElementById("hiddenInput");
const mobileInstruction = document.getElementById("mobileInstruction");

function sleep(ms) { 
    return new Promise(r => setTimeout(r, ms)); 
}

async function typeText(text, speed = 40) {
    for (let char of text) {
        typed.innerHTML += char === "\n" ? "<br>" : char;
        screen.scrollTop = screen.scrollHeight;
        await sleep(speed);
    }
}

async function typeGroups() {
    for (let g of groups) {
        typed.innerHTML += "<br><span class='group'>";
        for (let char of g) {
            typed.innerHTML += char;
            screen.scrollTop = screen.scrollHeight;
            await sleep(70);
        }
        typed.innerHTML += "</span>";
        await sleep(200);
    }
}

async function start() {
    await typeText(bootSequence, 20);
    await typeText(paragraphs, 35);
    await typeGroups();
    await typeText(ending, 30);
    
    // Add ASCII decoration
    typed.innerHTML += `<br><span class="ascii-border">└─────────────────────────────────────</span><br><br>`;
    
    createPasswordPrompt();
}
start();

let currentPassword = '';

function createPasswordPrompt() {
    // Remove old input container if it exists
    const oldContainer = document.getElementById('passwordInputContainer');
    if (oldContainer) {
        oldContainer.remove();
    }
    
    // Add the prompt with terminal style
    typed.innerHTML += `<span class="prompt">root@breach:~</span><span class="ascii-border">$</span> authenticate<br>`;
    
    // Create a new container for the input line
    const inputContainer = document.createElement('span');
    inputContainer.id = 'passwordInputContainer';
    inputContainer.className = 'input-line';
    inputContainer.innerHTML = ' ';
    typed.appendChild(inputContainer);
    
    screen.scrollTop = screen.scrollHeight;
    
    // Focus the hidden input for mobile - ENHANCED
    setTimeout(() => {
        hiddenInput.value = '';
        hiddenInput.focus();
        
        // Show keyboard instruction for mobile
        if (window.innerWidth <= 768) {
            mobileInstruction.style.display = 'block';
            setTimeout(() => {
                mobileInstruction.style.display = 'none';
            }, 3000);
        }
    }, 200);
    
    // Reset password
    currentPassword = '';
}

// Handle input from both desktop and mobile
function handlePasswordInput(e) {
    const inputContainer = document.getElementById('passwordInputContainer');
    if (!inputContainer) return;
    
    if (e.type === 'input') {
        currentPassword = e.target.value;
        inputContainer.innerHTML = ' ' + '•'.repeat(currentPassword.length);
        screen.scrollTop = screen.scrollHeight;
    }
}

// Handle Enter key
function handleKeyDown(e) {
    if (e.key === 'Enter' || e.keyCode === 13) {
        const inputContainer = document.getElementById('passwordInputContainer');
        if (inputContainer) {
            e.preventDefault();
            submitPassword();
        }
    }
}

async function submitPassword() {
    const inputContainer = document.getElementById('passwordInputContainer');
    if (!inputContainer) return;
    
    // Remove the input container with animation
    inputContainer.remove();
    
    typed.innerHTML += '<br><span class="ascii-border">├─</span> Authenticating';
    
    // Loading animation
    for (let i = 0; i < 3; i++) {
        await sleep(300);
        typed.innerHTML += '.';
        screen.scrollTop = screen.scrollHeight;
    }
    
    try {
        const res = await fetch('/api/login', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({password: currentPassword})
        });
        const data = await res.json();
        
        if (data.success) {
            typed.innerHTML += '<br><span class="ascii-border">└─</span> <span class="success">ACCESS GRANTED</span><br>';
            typed.innerHTML += '<span class="success">> Decrypting session token...</span><br>';
            typed.innerHTML += '<span class="success">> Establishing secure channel...</span><br>';
            typed.innerHTML += '<span class="success">> Redirecting to secure enclave...</span>';
            sessionStorage.setItem('auth', 'ok');
            
            hiddenInput.value = '';
            hiddenInput.blur();
            
            setTimeout(() => window.location = '/data-leaks.html', 2000);
        } else {
            typed.innerHTML += '<br><span class="ascii-border">└─</span> <span class="error">ACCESS DENIED</span><br>';
            typed.innerHTML += '<span class="error">> Invalid credentials</span><br>';
            typed.innerHTML += '<span class="error">> Attempt logged</span><br>';
            screen.scrollTop = screen.scrollHeight;
            
            hiddenInput.value = '';
            
            // Add delay before new prompt
            await sleep(800);
            createPasswordPrompt();
        }
    } catch(err) {
        typed.innerHTML += '<br><span class="ascii-border">└─</span> <span class="error">CONNECTION ERROR</span><br>';
        typed.innerHTML += '<span class="error">> Network unreachable</span><br>';
        screen.scrollTop = screen.scrollHeight;
        
        hiddenInput.value = '';
        
        await sleep(800);
        createPasswordPrompt();
    }
}

// Set up event listeners
hiddenInput.addEventListener('input', handlePasswordInput);
hiddenInput.addEventListener('keydown', handleKeyDown);

// Focus on screen click/touch - ENHANCED FOR MOBILE
function focusHiddenInput() {
    if (document.getElementById('passwordInputContainer')) {
        hiddenInput.focus();
        
        // Show feedback on mobile
        if (window.innerWidth <= 768) {
            mobileInstruction.style.display = 'block';
            setTimeout(() => {
                mobileInstruction.style.display = 'none';
            }, 1500);
        }
    }
}

screen.addEventListener('click', focusHiddenInput);
screen.addEventListener('touchstart', focusHiddenInput, { passive: true });

// Also focus when typing anywhere
document.addEventListener('keydown', function(e) {
    if (document.getElementById('passwordInputContainer')) {
        // Don't prevent default for special keys
        if (e.key.length === 1 || e.key === 'Backspace' || e.key === 'Enter') {
            hiddenInput.focus();
        }
    }
});

// Prevent body scroll when keyboard is open
window.addEventListener('scroll', function(e) {
    if (window.innerWidth <= 768) {
        window.scrollTo(0, 0);
    }
}, { passive: false });

// Clean up
window.addEventListener('beforeunload', function() {
    hiddenInput.removeEventListener('input', handlePasswordInput);
    hiddenInput.removeEventListener('keydown', handleKeyDown);
});

// Handle orientation change
window.addEventListener('orientationchange', function() {
    setTimeout(() => {
        screen.scrollTop = screen.scrollHeight;
    }, 100);
});
</script>

</body>
</html>